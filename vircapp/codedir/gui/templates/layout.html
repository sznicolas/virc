{% extends "bootstrap/base.html" %}
{% block styles %}
{{super()}}
<link rel="stylesheet"
      href="{{url_for('.static', filename='main.css')}}">
{% endblock %}

{% block title %}Virc{% endblock %}
{% block navbar %}
	<nav class="navbar-nav navbar-fixed-top bg-steel">
		<div class="container">
 			<a class="navbar-brand" href="/">Virc</a>
			<button class="navbar-toggle" data-toggle="collapse" data-target=".virc-menu">
					 <i class="glyphicon glyphicon-menu-hamburger"></i>
			</button>
			<div class="collapse navbar-collapse virc-menu">
				<ul class="nav navbar-nav">
					<li><a class="nav-item nav-link" href="{{ url_for('bots') }}">bots</a></li>
					<li><a class="nav-item nav-link" href="{{ url_for('trade_status') }}">trade status</a></li>
					<li class="dropdown">
						<a class="dropdown-toggle glyphicon glyphicon-wrench nav-link" data-toggle="dropdown" href="#">
								<span class="caret"></span>
						</a>
						<ul class="dropdown-menu">
							<li>
								<a class="nav-item nav-link" href="{{ url_for('redis_ls') }}">list redis</a>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
	</nav>
	<div class="container">
		{% with messages = get_flashed_messages(with_categories=true) %}
  			{% if messages %}
    			{% for category, message in messages %}
	      		<div class="alert alert-{{ category }} alert-dismissible" role="alert" data-dismiss='alert' data-toggle='tooltip' title='Click to close'>
    	  		{{ message }}
      			</div>
				{% endfor %}
			{% endif %}
		{% endwith %}
		<div id="flash"></div>
	</div>
	<div class="container">
		{% include 'includes/ticker_panel.html' %}
	</div>
{% endblock %}

{% block content %}
{% endblock %}

{% block scripts %}
{{super()}}

<script type="text/javascript" src="{{ url_for('static', filename='utils.js') }}"></script>
<script>
if (typeof(flashsse) !== "undefined") {
       flashsse.close();
}  
if (typeof(tickersse) !== "undefined") {
       tickersse.close();
}  
var tickersse = new EventSource("{{ url_for('sse.stream', channel='cb:mkt:tick:pubsub') }}");
var flashsse = new EventSource("{{ url_for('sse.stream', channel='gui:flash') }}"); 
flashsse.addEventListener('success', flashhandler) ;
flashsse.addEventListener('info', flashhandler) ;
flashsse.addEventListener('danger', flashhandler) ;
tickersse.addEventListener('update', tickerhandler) ;
</script>
{% endblock %}

{% extends "layout.html" %}
{% block content %}
<div class="row">
	<div class="col-sm-4">
		<h1>Create a Simple Bot</h1>
		<form method="POST" action="">
			<h2>Bot header</h2>
			{{ form.hidden_tag() }}
			<div class="row">
				<div class="col-sm-6"> {{ form.bot_name.label }} </div>
				<div class="col-sm-6"> {{ form.bot_name() }} </div>
			</div>
		  	<div class="row">
				<div class="col-sm-6"> {{ form.pair.label }} </div>
				<div class="col-sm-6"> {{ form.pair() }} </div>
			</div>
		  	<div class="row">
				<div class="col-sm-6"> {{ form.instructions_loop.label }} </div>
				<div class="col-sm-6"> {{ form.instructions_loop() }} </div>
			</div>
		  	<div class="row" data-toggle="tooltip" title="Choose cambista module">
				<div class="col-sm-6"> {{ form.cambista.label }} </div>
				<div class="col-sm-6"> {{ form.cambista() }} </div>
			</div>
	</div>
</div>
<div class="row">
	<div class="col-sm-4">
			<h2>Bot instructions</h2>
			<div class="row">
				<div class="col-sm-6"> {{ form.size.label }} </div>
				<div class="col-sm-6"> {{ form.size(class_="form_bot", size=5) }} </div>
			</div>
			<div class="row">
				<div class="col-sm-6"> {{ form.buy_at.label }} </div>
				<div class="col-sm-6"> {{ form.buy_at(class_="form_bot", size=8) }} </div>
			</div>
			<div class="row">
				<div class="col-sm-6"> {{ form.sell_at.label }} </div>
				<div class="col-sm-6"> {{ form.sell_at(class_="form_bot", size=8) }} </div>
			</div>
		  	<div class="row">
				<div class="col-sm-6"> {{ form.begin_sell.label }}</div>
				<div class="col-sm-6"> {{ form.begin_sell() }} </div>
			</div>
		  	<div class="row">
				<div class="col-sm-4"></div>
				<div class="col-sm-6"> {{ form.submit() }} </div>
			</div>
	  	</form>
	</div>
	<div class="col-sm-4">
			<h2>Expected profits</h2>
			<div class="row">
				<div class="col-sm-2">.</div>
			</div>
			<div class="row">
				<div class="col-sm-2">.</div>
				<div class="col-sm-4" id='buy_price'></div>
			</div>
			<div class="row">
				<div class="col-sm-2">.</div>
				<div class="col-sm-4" id='sell_price'></div>
			</div>
			<div class="row">
				<div class="col-sm-2">diff</div>
				<div class="col-sm-4" id='diff_price'></div>
			</div>
	</div>
</div>
{% endblock content %}
{% block scripts %}
{{super()}}
<script charset="utf-8" type="text/javascript">
$('input.form_bot').change(function () {
	if ($.isNumeric($("#f_size").val())){
		if ($.isNumeric($("#f_buy_at").val())){
			$("#buy_price").text(($("#f_buy_at").val() * $("#f_size").val()).toFixed(2));
		}
		if ($.isNumeric($("#f_sell_at").val())){
			$("#sell_price").text(($("#f_sell_at").val() * $("#f_size").val()).toFixed(2));
		}
	} 
	if ($("#buy_price").text() && $("#sell_price").text()) {
		diff_price = ($("#sell_price").text() - $("#buy_price").text()).toFixed(2);
		if (diff_price <= 0 ) {
			$("#diff_price").css("color", "red");
		} else { 		
			$("#diff_price").css("color", "");
		}
		$("#diff_price").text(diff_price);
	} else {
		$("#diff_price").text("?");
	}
});
</script>	
{% endblock %}
